<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ssdtools">
<title>Selecting Distributions • ssdtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selecting Distributions">
<meta property="og:description" content="ssdtools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ssdtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ssdtools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/distributions.html">Selecting Distributions</a>
    <a class="dropdown-item" href="../articles/exposure-plots.html">Embellishing Plots with an Exposure Distribution</a>
    <a class="dropdown-item" href="../articles/faqs.html">Frequently Asked Questions</a>
    <a class="dropdown-item" href="../articles/small-sample-bias-ref.html">Small sample bias in estimates - reference</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcgov/ssdtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selecting Distributions</h1>
                        <h4 data-toc-skip class="author">ssdtools
Team</h4>
            
            <h4 data-toc-skip class="date">2023-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bcgov/ssdtools/blob/HEAD/vignettes/distributions.Rmd" class="external-link"><code>vignettes/distributions.Rmd</code></a></small>
      <div class="d-none name"><code>distributions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="model-selection">Model selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h2>
<p>It can be difficult to select a ‘best fitting’ distribution when
modeling species sensitivity data with low sample sizes. In these
situations, model averaging can be used to fit multiple distributions
and calculate a weighted average HCx and confidence limits <span class="citation">(Schwarz and Tillmanns 2019)</span>. Distributions
selected to use in model averaging must be bounded by zero given that
effect concentrations cannot be negative. Furthermore, the selected
distributions should provide a variety of shapes to capture the
diversity of shapes in empirical species sensitivity distributions.</p>
<p>By default, the ssdtools uses Akaike Information Criterion corrected
for small sample size (AICc) as a measure of relative quality of fit for
different distributions and as the basis for calculating the
model-averaged HCx.<br>
However, if two or more similar models fit the data well then the
support for this type of shape will be over-inflated <span class="citation">(Burnham and Anderson 2002)</span>.</p>
</div>
<div class="section level2">
<h2 id="default-distributions">Default Distributions<a class="anchor" aria-label="anchor" href="#default-distributions"></a>
</h2>
<p>To avoid such model redundancy <span class="citation">(Burnham and
Anderson 2002)</span>, ssdtools and the accompanying Shiny app <span class="citation">(Dalgarno 2021)</span> fit three different shape
distributions by default: the log-normal, log-logistic and gamma.</p>
<p>The three distributions are plotted below with a mean of 2 and
standard deviation of 2 on the (natural) log concentration scale or
around 7.4 on the concentration scale.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bcgov/ssdtools" class="external-link">ssdtools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in checkMatrixPackageVersion(getOption("TMB.check.Matrix", TRUE)): Package version inconsistency detected.</span></span>
<span><span class="co">#&gt; TMB was built with Matrix version 1.6.3</span></span>
<span><span class="co">#&gt; Current Matrix version is 1.6.1.1</span></span>
<span><span class="co">#&gt; Please re-install 'TMB' from source using install.packages('TMB', type = 'source') or ask CRAN for a binary version of 'TMB' matching CRAN's 'Matrix' package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ssd_plot_cdf.html">ssd_plot_cdf</a></span><span class="op">(</span><span class="fu"><a href="../reference/ssd_match_moments.html">ssd_match_moments</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">2</span>, sdlog <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_colour_ssd.html">scale_color_ssd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="distributions_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
<div class="section level3">
<h3 id="log-normal-distribution">Log-normal distribution<a class="anchor" aria-label="anchor" href="#log-normal-distribution"></a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Log-normal_distribution" class="external-link">log-normal</a>
distribution was selected as the starting distribution given the data
are for effect concentrations.</p>
<p>The log-normal distribution does have a couple limitations to
consider when fitting species sensitivity data. First, on the
logarithmic scale, the normal distribution is symmetrical. Second, the
log-normal distribution decays too quickly in the tails giving narrow
tails which may not adequately fit the data. Additional distributions
were selected to compensate for these deficiencies.</p>
</div>
<div class="section level3">
<h3 id="log-logistic-distribution">Log-logistic distribution<a class="anchor" aria-label="anchor" href="#log-logistic-distribution"></a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Log-logistic_distribution" class="external-link">log-logistic</a>
distribution is often used as a candidate SSD primarily because of its
analytic tractability <span class="citation">(Aldenberg and Slob
1993)</span>. We included it because it has wider tails than the
log-normal and because it is a specific case of the more general Burr
family of distributions <span class="citation">Burr (1942)</span>.</p>
</div>
<div class="section level3">
<h3 id="gamma-distribution">Gamma distribution<a class="anchor" aria-label="anchor" href="#gamma-distribution"></a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Gamma_distribution" class="external-link">gamma</a>
distribution is a two-parameter distribution commonly used to model
failure times or time to events. For use in modeling species sensitivity
data, the gamma distribution has two key features that provide
additional flexibility relative to the log-normal distribution: 1) it is
non-symmetrical on the logarithmic scale; and 2) it has wider tails. The
Weibull distribution was considered as an alternative but the Gamma
distribution is generally more flexible.</p>
</div>
</div>
<div class="section level2">
<h2 id="all-distributions">All Distributions<a class="anchor" aria-label="anchor" href="#all-distributions"></a>
</h2>
<p>For completeness the hazard concentrations for the other stable
distributions provided by <code>ssdtools</code> are plotted below with a
mean of 2 and standard deviation of 2 on the (natural) log concentration
scale.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ssd_plot_cdf.html">ssd_plot_cdf</a></span><span class="op">(</span><span class="fu"><a href="../reference/ssd_match_moments.html">ssd_match_moments</a></span><span class="op">(</span>dists <span class="op">=</span> <span class="fu"><a href="../reference/ssd_dists_all.html">ssd_dists_all</a></span><span class="op">(</span><span class="op">)</span>, meanlog <span class="op">=</span> <span class="fl">2</span>, sdlog <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_colour_ssd.html">scale_color_ssd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: This manual palette can handle a maximum of 8 values. You have</span></span>
<span><span class="co">#&gt; supplied 10</span></span>
<span><span class="co">#&gt; Warning: Removed 198 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="distributions_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aldenberg_confidence_1993" class="csl-entry">
Aldenberg, T., and W. Slob. 1993. <span>“Confidence <span>Limits</span>
for <span>Hazardous</span> <span>Concentrations</span>
<span>Based</span> on <span>Logistically</span> <span>Distributed</span>
<span>NOEC</span> <span>Toxicity</span> <span>Data</span>.”</span>
<em>Ecotoxicology and Environmental Safety</em> 25 (1): 48–63. <a href="https://doi.org/10.1006/eesa.1993.1006" class="external-link">https://doi.org/10.1006/eesa.1993.1006</a>.
</div>
<div id="ref-burnham_model_2002" class="csl-entry">
Burnham, Kenneth P., and David R. Anderson, eds. 2002. <em>Model
<span>Selection</span> and <span>Multimodel</span>
<span>Inference</span></em>. New York, NY: Springer New York. <a href="https://doi.org/10.1007/b97636" class="external-link">https://doi.org/10.1007/b97636</a>.
</div>
<div id="ref-burr_cumulative_1942" class="csl-entry">
Burr, Irving W. 1942. <span>“Cumulative <span>Frequency</span>
<span>Functions</span>.”</span> <em>The Annals of Mathematical
Statistics</em> 13 (2): 215–32.
</div>
<div id="ref-dalgarno_shinyssdtools_2021" class="csl-entry">
Dalgarno, Seb. 2021. <span>“Shinyssdtools: <span>A</span> Web
Application for Fitting <span>Species</span> <span>Sensitivity</span>
<span>Distributions</span> (<span>SSDs</span>).”</span> <em>Journal of
Open Source Software</em> 6 (57): 2848. <a href="https://doi.org/10.21105/joss.02848" class="external-link">https://doi.org/10.21105/joss.02848</a>.
</div>
<div id="ref-schwarz_improving_2019" class="csl-entry">
Schwarz, Carl, and Angeline Tillmanns. 2019. <span>“Improving
<span>Statistical</span> <span>Methods</span> for <span>Modeling</span>
<span>Species</span> <span>Sensitivity</span>
<span>Distributions</span>.”</span> WSS2019-07. Victoria, BC: Province
of British Columbia.
</div>
<div id="ref-shao_estimation_2000" class="csl-entry">
Shao, Quanxi. 2000. <span>“Estimation for Hazardous Concentrations Based
on <span>NOEC</span> Toxicity Data: An Alternative Approach,”</span> 13.
</div>
</div>
</div>
<div class="section level2">
<h2 id="licensing">Licensing<a class="anchor" aria-label="anchor" href="#licensing"></a>
</h2>
<p>Copyright 2023 Province of British Columbia, Environment and Climate
Change Canada, and Australian Government Department of Climate Change,
Energy, the Environment and Water</p>
<p>The documentation is released under the <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">CC BY 4.0
License</a></p>
<p>The code is released under the <a href="https://www.apache.org/licenses/LICENSE-2.0" class="external-link">Apache License
2.0</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/joethorley" class="external-link">Joe Thorley</a>, <a href="https://www.sfu.ca/stat-actsci/department/profiles/carl-schwarz.html" class="external-link">Carl Schwarz</a>, <a href="https://www.aims.gov.au/about/our-people/dr-rebecca-fisher" class="external-link">Rebecca Fisher</a>, <a href="https://training.ecotox.science/who-we-are/" class="external-link">David Fox</a>, <a href="https://www2.gov.bc.ca/" class="external-link">Province of British Columbia</a>, <a href="https://www.canada.ca/en/environment-climate-change.html" class="external-link">Environment and Climate Change Canada</a>, <a href="https://www.dcceew.gov.au/" class="external-link">Australian Government Department of Climate Change, Energy, the Environment and Water</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
