<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ssdtools">
<title>Confidence Intervals for Hazard Concentrations â€¢ ssdtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence Intervals for Hazard Concentrations">
<meta property="og:description" content="ssdtools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ssdtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6.9015</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ssdtools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcgov/ssdtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Confidence Intervals for Hazard Concentrations</h1>
                        <h4 data-toc-skip class="author">ssdtools
Team</h4>
            
            <h4 data-toc-skip class="date">2024-05-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bcgov/ssdtools/blob/HEAD/vignettes/articles/confidence-intervals.Rmd" class="external-link"><code>vignettes/articles/confidence-intervals.Rmd</code></a></small>
      <div class="d-none name"><code>confidence-intervals.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="bootstrap-confidence-intervals">Bootstrap confidence intervals<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals"></a>
</h2>
<p>Bootstrapping is a resampling technique used to obtain estimates of
summary statistics. The team have explored the use of alternative
methods for obtaining the confidence interval of <em>HCx</em> estimates.
This included using the closed-form expression for the
variance-covariance matrix of the parameters of the Burr III
distribution, coupled with the delta-method, as well as an alternative
bootstrap method for the inverse Pareto distribution based on
statistical properties of the parameters <span class="citation">(Fox et
al. 2021)</span>. In both cases, it appeared that these methods can give
results similar to other traditional bootstrapping approaches in much
less time, and are therefore potentially worth further investigation.
However, implementation of such methods across all the distributions now
available in ssdtools would be a substantial undertaking.</p>
<p>The revised version of ssdtools retains the computationally intensive
bootstrapping method to obtain confidence intervals and an estimate of
standard errors. We recommend a minimum bootstrap sample of 1,000 (the
current default - see argument nboot in <em>?ssd_hc()</em>). However,
more reliable results can be obtained using samples of 5,000 or 10,000.
We recommend larger bootstrap samples for final reporting.</p>
</div>
<div class="section level2">
<h2 id="parametric-versus-non-parametric-bootstrapping">Parametric versus non-parametric bootstrapping<a class="anchor" aria-label="anchor" href="#parametric-versus-non-parametric-bootstrapping"></a>
</h2>
<p>Burrlioz 2.0 uses a non-parametric bootstrap method to obtain
confidence intervals on the <em>HCx</em> estimate. Non-parametric
bootstrapping is carried out by repeatedly resampling the raw data with
replacement, and refitting the distribution many times. The 95%
confidence limits are then obtained by calculating the lower 0.025th and
upper 0.975th quantiles of the resulting <em>HCx</em> estimates across
all the bootstrap samples (typically &gt;1000). This type of bootstrap
takes into account uncertainty in the distribution fit based on
uncertainty in the data.</p>
<p>The ssdtools package by default uses a parametric bootstrap. Instead
of resampling the data, parametric bootstrapping draws a random a set of
new data (of the same sample size as the original) from the fitted
distribution to repeatedly refit the distribution. Upper and lower 95%
bounds are again calculated as the lower 0.025th and upper 0.975th
quantiles of the resulting <em>HCx</em> estimates across all the
bootstrap samples (again, typically &gt;1000). This will capture the
possible uncertainty that may occur for a sample size from a given
distribution, but it assumes no uncertainty in that original fit, so it
is not accounting for uncertainty in the input data.</p>
<p>The new TMB version of ssdtools has the capacity to do bootstrapping
either using the Burrlioz non-parametric method, or the original
parametric method of ssdtools (based on fitdistrplus <span class="citation">(Delignette-Muller and Dutang 2015)</span>).</p>
<p>Using simulation studies the ssdtools team examined bias and compared
the resulting coverage of the parametric and non-parametric
bootstrapping methods <span class="citation">(Fox et al. 2021)</span>.
They found that coverage was better using the parametric bootstrapping
method, and this has been retained as the default bootstrapping method
in the update to ssdtools.</p>
</div>
<div class="section level2">
<h2 id="bootstrapping-model-averaged-ssds">Bootstrapping model-averaged SSDs<a class="anchor" aria-label="anchor" href="#bootstrapping-model-averaged-ssds"></a>
</h2>
<p>Bootstrapping to obtain confidence intervals for individual fitted
distributions is relatively straightforward. However, obtaining
bootstrap confidence intervals for model-averaged SSDs requires careful
consideration, as the procedure is subject to the same pitfalls evident
when obtaining model-averaged <em>HCx</em> estimates. The <a href="/model_averaging.html">Model Average SSDs</a> vignette contains a
detailed explanation of the fallacy of using the summed weighting of
individual <em>HCx</em> values (as weighted arithmetic average), and how
this can lead to spurious results. Model-averaged estimates and/or
confidence intervals (including standard error) can be calculated by
treating the distributions as constituting a single mixture distribution
versus â€˜taking the meanâ€™. When calculating the model-averaged estimates
treating the distributions as constituting a single mixture distribution
ensures that <em>ssd_hc()</em> is the inverse of <em>ssd_hp()</em>, and
this applies for model-averaged confidence intervals.</p>
<p>The revised version of ssdtools supports four methods for obtaining
bootstrap confidence intervals, and these are discussed in detail
below.</p>
<div class="section level3">
<h3 id="weighted-arithmetic-mean">Weighted arithmetic mean<a class="anchor" aria-label="anchor" href="#weighted-arithmetic-mean"></a>
</h3>
<p>The early versions of ssdtools provided model-averaged confidence
intervals (cis) and standard errors (se) that were calculated as
weighted arithmetic means of the upper and lower cis and se values
obtained via bootstrap simulation from each of the individual candidate
distributions independently. This method is incorrect and may lead to
spurious results (as described above) and has been shown via simulations
studies to result in confidence intervals with very low coverage. The
current version of ssdtools retains the functionality to reproduce the
original behavior of ssdtools.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssd_fit_dists.html">ssd_fit_dists</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">ssddata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ssddata/man/ccme_silver.html" class="external-link">ccme_silver</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ssd_hc.html">ssd_hc</a></span><span class="op">(</span><span class="va">fit</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, multi_est <span class="op">=</span> <span class="cn">FALSE</span>, ci_method <span class="op">=</span> <span class="st">"weighted_arithmetic"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 11</span></span></span>
<span><span class="co">#&gt;   dist    proportion   est    se    lcl   ucl    wt method   nboot pboot samples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;I&lt;lis&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> average       0.05 0.192 0.216 0.067<span style="text-decoration: underline;">9</span> 0.861     1 parametâ€¦  <span style="text-decoration: underline;">1</span>000 0.998 <span style="color: #949494;">&lt;dbl&gt;</span></span></span></code></pre></div>
<p>Use of this method for obtaining ci and se values is not recommended
and only retained for legacy comparison purposes. It is both technically
incorrect, and computationally inefficient.</p>
</div>
<div class="section level3">
<h3 id="weighted-mixture-distribution">Weighted mixture distribution<a class="anchor" aria-label="anchor" href="#weighted-mixture-distribution"></a>
</h3>
<p>A more theoretically correct way of obtaining ci and se values is to
consider the model average set as a mixture distribution (see above, and
the <a href="model_averaging.html">Model Average SSDs</a> vignette).
When we consider the model set as a mixture distribution, bootstrapping
is achieved by resampling from the model set according to the AICc based
model weights. A method for sampling from mixture distributions has been
implemented in ssdtools, via the function <em>ssd_rmulti()</em>, which
will generate random samples from a mixture of any combination of
distributions currently implemented in <code>ssdtools</code>.</p>
<p>When bootstrapping from the mixture distribution, a question arises
whether the model weights should be re-estimated for every bootstrap
sample, or fixed at the values estimated from the models fitted to the
original sample of toxicity data? This is an interesting question that
may warrant further investigation, however our current view is that they
should be fixed at their nominal values in the same way that the
component distributions to be used in bootstrapping are informed by the
fit to the sample toxicity data. Using simulation studies we explored
the coverage and bias of ci values obtained without and without fixing
the distribution weights, and results indicate little difference.</p>
<p>The following code can be used to obtain confidence intervals for
<em>HCx</em> estimates via bootstrapping from the weighted mixture
distribution (using <em>ssd_rmulti()</em>), with and without fixed
weight values respectively.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the multi boostrapping method with fixed weights</span></span>
<span><span class="fu"><a href="../reference/ssd_hc.html">ssd_hc</a></span><span class="op">(</span><span class="va">fit</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci_method <span class="op">=</span> <span class="st">"multi_fixed"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 11</span></span></span>
<span><span class="co">#&gt;   dist    proportion   est    se    lcl   ucl    wt method   nboot pboot samples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;I&lt;lis&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> average       0.05 0.190 0.207 0.019<span style="text-decoration: underline;">4</span> 0.824     1 parametâ€¦  <span style="text-decoration: underline;">1</span>000     1 <span style="color: #949494;">&lt;dbl&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the multi boostrapping method without fixed weights</span></span>
<span><span class="fu"><a href="../reference/ssd_hc.html">ssd_hc</a></span><span class="op">(</span><span class="va">fit</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci_method <span class="op">=</span> <span class="st">"multi_free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 11</span></span></span>
<span><span class="co">#&gt;   dist    proportion   est    se    lcl   ucl    wt method   nboot pboot samples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;I&lt;lis&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> average       0.05 0.190 0.211 0.022<span style="text-decoration: underline;">3</span> 0.838     1 parametâ€¦  <span style="text-decoration: underline;">1</span>000     1 <span style="color: #949494;">&lt;dbl&gt;</span></span></span></code></pre></div>
<p>Use of this method (without or without fixed weights) is
theoretically correct, but is computationally very inefficient.</p>
</div>
<div class="section level3">
<h3 id="weighted-bootstrap-sample">Weighted bootstrap sample<a class="anchor" aria-label="anchor" href="#weighted-bootstrap-sample"></a>
</h3>
<p>The developers of <code>ssdtools</code> investigated a third method
for obtaining confidence intervals for the model-averaged SSD. This
method bootstraps from each of the distributions individually, taking a
weighted sample from each, and then combining these into a pooled
bootstrap sample for estimation of te ci and se values. Pseudo code for
this method is as follows:</p>
<ul>
<li><p>For each distribution in the <code>fitdists</code> object, the
proportional number of bootstrap samples to draw
(<code>nboot_vals</code>) is found using
<code>round(nboot * weight)</code>, where <code>nboot</code> is the
total number of bootstrap samples and weight is the AICc based model
weights for each distribution based on the original
<code>ssd_fitdist</code> fit.</p></li>
<li><p>For each of the <code>nboot_vals</code> for each distribution, a
random sample of size N is drawn (the total number of original data
points included in the original SSD fit) based on the estimated
parameters from the original data for that distribution.</p></li>
<li><p>The random sample is re-fitting using that distribution.</p></li>
<li><p><em>HCx</em> is estimated from the re-fitted bootstrap
fit.</p></li>
<li><p>The <em>HCx</em> estimates for all <code>nboot_vals</code> for
each distribution are then pooled across all distributions, and
<em>quantile()</em> is used to determine the lower and upper confidence
bounds for this pooled weighted bootstrap sample of <em>HCx</em>
values.</p></li>
</ul>
<p>This method does not draw random samples from the mixture
distribution using <em>ssd_rmulti</em>. While mathematically the method
shares some properties with obtaining <em>HCx</em> estimates via summing
the weighted values (weighted arithmetic mean), simulation studies have
shown that, as a method for obtaining confidence intervals, this pooled
weighted sample method yields similar ci values and coverage the
<em>ssd_rmulti()</em> method, and is computationally much faster.</p>
<p>This method is currently the default method in ssdtools, and can be
implemented by simply calling <code><a href="../reference/ssd_hc.html">ssd_hc()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using a weighted pooled bootstrap sample</span></span>
<span><span class="fu"><a href="../reference/ssd_hc.html">ssd_hc</a></span><span class="op">(</span><span class="va">fit</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 11</span></span></span>
<span><span class="co">#&gt;   dist    proportion   est    se    lcl   ucl    wt method   nboot pboot samples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;I&lt;lis&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> average       0.05 0.190 0.214 0.018<span style="text-decoration: underline;">1</span> 0.816     1 parametâ€¦  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparing-bootrapping-methods">Comparing bootrapping methods<a class="anchor" aria-label="anchor" href="#comparing-bootrapping-methods"></a>
</h2>
<p>We have undertaken extensive simulation studies comparing the
implemented methods, and the results of these are reported elsewhere.
For illustrative purposes, here we compare upper and lower confidence
intervals using only a single example data set, the Silver data set from
the Canadian Council of Ministers of the Environment (ccme).</p>
<p>Using the default settings for ssdtools, we compared the upper and
lower confidence intervals for the four bootstrapping methods described
above. Estimate upper confidence limits are relatively similar among the
four methods. However, the lower confidence interval obtained using the
weighted arithmetic mean (the method implemented in earlier versions of
ssdtools) is much higher than the other three methods, potentially
accounting for the relatively poor coverage of this method in our
simulation studies.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">compare_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">ucl</span>, fill <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">compare_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">lcl</span>, fill <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>,common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="confidence-intervals_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Given the similarity of upper and lower confidence intervals of the
weighted bootstrap sample method compared to the potentially more
theoretically correct, but computationally more intensive weighted
mixture method (via <em>ssd_rmulti()</em>), we also compared the time
taken to undertake bootstrapping across the methods.</p>
<p>Using the default 1,000 bootstrap samples, the elapsed time to
undertake bootstrapping for the mixture method was 29.07 seconds,
compared to 2.66 seconds for the weighted bootstrap sample. This means
that the weighted bootstrap method is ~ 11 times faster, representing a
considerable computational saving across many SSDs. For this reason,
this method is currently set as the default method for confidence
interval estimation in ssdtools.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">compare_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">time</span>, fill <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Elapsed time (seconds)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span></span></code></pre></div>
<p><img src="confidence-intervals_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fitdistrplus" class="csl-entry">
Delignette-Muller ML, Dutang C (2015) <a href="http://www.jstatsoft.org/v64/i04/" class="external-link"><span class="nocase">fitdistrplus</span>: An <span>R</span> package for
fitting distributions</a>. Journal of Statistical Software 64:1â€“34
</div>
<div id="ref-fox_methodologies_2021" class="csl-entry">
Fox DR, Fisher R, Thorley JL, Schwarz C (2021) <a href="https://environmetrics.net/docs/FOX%20and%20FISHER%20Final_final_report_rev2.3.pdf?189db0&amp;189db0" class="external-link">Joint
investigation into <span class="nocase">statistical</span> <span class="nocase">methodologies</span> underpinning the <span class="nocase">derivation</span> of <span class="nocase">toxicant</span>
<span class="nocase">guideline</span> <span class="nocase">values</span>
in <span>Australia</span> and <span>New Zealand</span></a>.
Environmetrics Australia; Australian Institute of Marine Science
</div>
</div>
</div>
<div class="section level2">
<h2 id="licensing">Licensing<a class="anchor" aria-label="anchor" href="#licensing"></a>
</h2>
<p>Copyright 2018-2024 Province of British Columbia<br>
Copyright 2021 Environment and Climate Change Canada<br>
Copyright 2023-2024 Australian Government Department of Climate Change,
Energy, the Environment and Water</p>
<p>The documentation is released under the <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">CC BY 4.0
License</a></p>
<p>The code is released under the <a href="https://www.apache.org/licenses/LICENSE-2.0" class="external-link">Apache License
2.0</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joethorley" class="external-link">Joe Thorley</a>, <a href="https://www.aims.gov.au/about/our-people/dr-rebecca-fisher" class="external-link">Rebecca Fisher</a>, <a href="https://training.ecotox.science/who-we-are/" class="external-link">David Fox</a>, <a href="https://www.sfu.ca/stat-actsci/department/profiles/carl-schwarz.html" class="external-link">Carl Schwarz</a>, <a href="https://www2.gov.bc.ca/" class="external-link">Province of British Columbia</a>, <a href="https://www.canada.ca/en/environment-climate-change.html" class="external-link">Environment and Climate Change Canada</a>, <a href="https://www.dcceew.gov.au/" class="external-link">Australian Government Department of Climate Change, Energy, the Environment and Water</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
