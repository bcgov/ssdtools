<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ssdtools">
<title>Embellishing Plots with an Exposure Distribution • ssdtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Embellishing Plots with an Exposure Distribution">
<meta property="og:description" content="ssdtools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ssdtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ssdtools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/distributions.html">Selecting Distributions</a>
    <a class="dropdown-item" href="../articles/exposure-plots.html">Embellishing Plots with an Exposure Distribution</a>
    <a class="dropdown-item" href="../articles/faqs.html">Frequently Asked Questions</a>
    <a class="dropdown-item" href="../articles/small-sample-bias-ref.html">Small sample bias in estimates - reference</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcgov/ssdtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Embellishing Plots with an Exposure Distribution</h1>
                        <h4 data-toc-skip class="author">ssdtools
Team</h4>
            
            <h4 data-toc-skip class="date">2023-10-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bcgov/ssdtools/blob/HEAD/vignettes/exposure-plots.Rmd" class="external-link"><code>vignettes/exposure-plots.Rmd</code></a></small>
      <div class="d-none name"><code>exposure-plots.Rmd</code></div>
    </div>

    
    
<p>The <code>ssdtools</code> package produces a plot of the cumulative
distributions for multiple distribution through the use of the
<code><a href="../reference/ssd_plot_cdf.html">ssd_plot_cdf()</a></code> function. For example, consider the boron
data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bcgov/ssdtools" class="external-link">ssdtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssd_fit_dists.html">ssd_fit_dists</a></span><span class="op">(</span><span class="fu">ssddata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ssddata/man/ccme_boron.html" class="external-link">ccme_boron</a></span><span class="op">)</span></span>
<span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssd_plot_cdf.html">ssd_plot_cdf</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_colour_ssd.html">scale_color_ssd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gp</span><span class="op">)</span></span></code></pre></div>
<p><img src="exposure-plots_files/figure-html/unnamed-chunk-1-1.png" width="576"></p>
<p>This graphic is a <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot</a>
object and so can be saved and embellished in the usual way. For
example, suppose we want to superimpose an environmental concentration
cumulative distribution and compute the exposure risk as outlined in
<span class="citation">Verdonck et al. (2003)</span>.</p>
<p>Finding a suitable probability distribution to describe the exposure
concentration is beyond the scope of this document – we will assume that
this has been done elsewhere. In particular, suppose that the exposure
concentration follows a log-normal distribution with a mean of -2.3 and
a standard deviation of 1 on the logarithmic scale. From the exposure
distribution, we construct a data frame with the concentration values
and the cumulative probability of seeing this exposure or less in the
environment.</p>
<p>Notice that some care is needed because the ssdtools plot is on the
logarithmic base 10 scale and not the natural logarithm base <span class="math inline">\(e\)</span> scale.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex.cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Conc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># generate a grid of concentrations</span></span>
<span><span class="va">ex.cdf</span><span class="op">$</span><span class="va">ex.cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="va">ex.cdf</span><span class="op">$</span><span class="va">Conc</span>,</span>
<span>  meanlog <span class="op">=</span> <span class="va">ex.mean.log</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="va">ex.sd.log</span></span>
<span><span class="op">)</span> <span class="co"># generate the cdf</span></span></code></pre></div>
<p>We now add this to the plot</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ex.cdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Conc</span>, y <span class="op">=</span> <span class="va">ex.cdf</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Exposure distribution"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1.08</span> <span class="op">*</span> <span class="va">ex.cdf</span><span class="op">$</span><span class="va">Conc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">ex.cdf</span><span class="op">$</span><span class="va">ex.cdf</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0.5</span>, angle <span class="op">=</span> <span class="fl">75</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="exposure-plots_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>The <code>ssdtools</code> package contains a function
<code><a href="../reference/ssd_exposure.html">ssd_exposure()</a></code> that computes the risk as defined by
Verdonck et al (2003) representing the average proportion of species at
risk.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">ex.risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssd_exposure.html">ssd_exposure</a></span><span class="op">(</span><span class="va">fits</span>, meanlog <span class="op">=</span> <span class="va">ex.mean.log</span>, sdlog <span class="op">=</span> <span class="va">ex.sd.log</span><span class="op">)</span></span>
<span><span class="va">ex.risk</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0062416</span></span></code></pre>
<p>The risk of 0.00624 can also be added to the plot in the usual
way:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">ex.cdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Conc</span>, y <span class="op">=</span> <span class="va">ex.cdf</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Exposure distribution"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1.08</span> <span class="op">*</span> <span class="va">ex.cdf</span><span class="op">$</span><span class="va">Conc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">ex.cdf</span><span class="op">$</span><span class="va">ex.cdf</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0.5</span>, angle <span class="op">=</span> <span class="fl">75</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Verdonck risk :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ex.risk</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">Inf</span>, y <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">1.1</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="exposure-plots_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<div class="section level2">
<h2 id="other-embellishments">Other embellishments<a class="anchor" aria-label="anchor" href="#other-embellishments"></a>
</h2>
<p>Other embellishments can be added in a similar fashion using the
features of <a href="https://ggplot2.tidyverse.org" class="external-link"><em>ggplot</em></a>
and are not discussed here.</p>
<hr>
<p><a rel="license" href="https://creativecommons.org/licenses/by/4.0/" class="external-link"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">ssdtools</span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">the Province of British Columbia </span>
is licensed under a
<a rel="license" href="https://creativecommons.org/licenses/by/4.0/" class="external-link">
Creative Commons Attribution 4.0 International License</a>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Verdonck, F. A., Aldenberg, T. , Jaworska, J. and Vanrolleghem, P. A.
(2003), Limitations of current risk characterization methods in
probabilistic environmental risk assessment. Environmental Toxicology
and Chemistry, 22: 2209-2213. <a href="https://doi.org/10.1897/02-435" class="external-link uri">https://doi.org/10.1897/02-435</a></p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-verdonck_limitations_2003" class="csl-entry">
Verdonck, Frederik A. M., Tom Aldenberg, Joanna Jaworska, and Peter A.
Vanrolleghem. 2003. <span>“Limitations of <span>Current</span>
<span>Risk</span> <span>Characterization</span> <span>Methods</span> in
<span>Probabilistic</span> <span>Environmental</span> <span>Risk</span>
<span>Assessment</span>.”</span> <em>Environmental Toxicology and
Chemistry</em> 22 (9): 2209. <a href="https://doi.org/10.1897/02-435" class="external-link">https://doi.org/10.1897/02-435</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/joethorley" class="external-link">Joe Thorley</a>, <a href="https://www.sfu.ca/stat-actsci/department/profiles/carl-schwarz.html" class="external-link">Carl Schwarz</a>, <a href="https://www.aims.gov.au/about/our-people/dr-rebecca-fisher" class="external-link">Rebecca Fisher</a>, <a href="https://training.ecotox.science/who-we-are/" class="external-link">David Fox</a>, <a href="https://www2.gov.bc.ca/" class="external-link">Province of British Columbia</a>, <a href="https://www.canada.ca/en/environment-climate-change.html" class="external-link">Environment and Climate Change Canada</a>, <a href="https://www.dcceew.gov.au/" class="external-link">Australian Government Department of Climate Change, Energy, the Environment and Water</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
