<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ssdtools">
<title>Get Started with ssdtools • ssdtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Started with ssdtools">
<meta property="og:description" content="ssdtools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ssdtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6.9015</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ssdtools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/distributions.html">Selecting Distributions</a>
    <a class="dropdown-item" href="../articles/exposure-plots.html">Embellishing Plots with an Exposure Distribution</a>
    <a class="dropdown-item" href="../articles/faqs.html">Frequently Asked Questions</a>
    <a class="dropdown-item" href="../articles/small-sample-bias-ref.html">Small sample bias in estimates - reference</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcgov/ssdtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Started with ssdtools</h1>
                        <h4 data-toc-skip class="author">ssdtools
Team</h4>
            
            <h4 data-toc-skip class="date">2024-05-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bcgov/ssdtools/blob/HEAD/vignettes/ssdtools.Rmd" class="external-link"><code>vignettes/ssdtools.Rmd</code></a></small>
      <div class="d-none name"><code>ssdtools.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>ssdtools</code> is an R package to fit Species Sensitivity
Distributions (SSDs) using Maximum Likelihood and model averaging.</p>
<p>SSDs are cumulative probability distributions that are used to
estimate the percent of species that are affected by a given
concentration of a chemical. The concentration that affects 5% of the
species is referred to as the 5% Hazard Concentration (<span class="math inline">\(HC_5\)</span>). For more information on SSDs the
reader is referred to <span class="citation">Posthuma, Suter II, and
Traas (2001)</span>.</p>
<p>In order to use <code>ssdtools</code> you need to install R (see
below) or use the Shiny <a href="https://github.com/bcgov/shinyssdtools" class="external-link">app</a>. The shiny app
includes a user guide. This vignette is a user manual for the R
package.</p>
</div>
<div class="section level2">
<h2 id="philosophy">Philosophy<a class="anchor" aria-label="anchor" href="#philosophy"></a>
</h2>
<p><code>ssdtools</code> provides the key functionality required to fit
SSDs using Maximum Likelihood and model averaging in R. It is intended
to be used in conjunction with <a href="https://www.tidyverse.org" class="external-link">tidyverse</a> packages such as
<code>readr</code> to input data, <code>tidyr</code> and
<code>dplyr</code> to group and manipulate data and <code>ggplot2</code>
<span class="citation">(Wickham 2016)</span> to plot data. As such it
endeavors to fulfill the tidyverse <a href="https://tidyverse.tidyverse.org/articles/manifesto.html" class="external-link">manifesto</a>.</p>
</div>
<div class="section level2">
<h2 id="installing">Installing<a class="anchor" aria-label="anchor" href="#installing"></a>
</h2>
<p>In order to install R <span class="citation">(R Core Team
2018)</span> the appropriate binary for the users operating system
should be downloaded from <a href="https://cran.r-project.org" class="external-link">CRAN</a>
and then installed.</p>
<p>Once R is installed, the <code>ssdtools</code> package can be
installed (together with the tidyverse) by executing the following code
at the R console</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ssdtools"</span>, <span class="st">"tidyverse"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>ssdtools</code> package (and ggplot2 package) can then be
loaded into the current session using</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bcgov/ssdtools" class="external-link">ssdtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>To get additional information on a particular function just type
<code>?</code> followed by the name of the function at the R console.
For example <code><a href="../reference/ssd_gof.html">?ssd_gof</a></code> brings up the R documentation for the
<code>ssdtools</code> goodness of fit function.</p>
<p>For more information on using R the reader is referred to <a href="https://r4ds.had.co.nz" class="external-link">R for Data Science</a> <span class="citation">(Wickham and Grolemund 2016)</span>.</p>
<p>If you discover a bug in <code>ssdtools</code> please file an issue
with a <a href="https://reprex.tidyverse.org/articles/reprex-dos-and-donts.html" class="external-link">reprex</a>
(repeatable example) at <a href="https://github.com/bcgov/ssdtools/issues" class="external-link uri">https://github.com/bcgov/ssdtools/issues</a>.</p>
</div>
<div class="section level2">
<h2 id="inputting-data">Inputting Data<a class="anchor" aria-label="anchor" href="#inputting-data"></a>
</h2>
<p>Once the <code>ssdtools</code> package has been loaded the next task
is to input some data. An easy way to do this is to save the
concentration data for a <em>single</em> chemical as a column called
<code>Conc</code> in a comma separated file (<code>.csv</code>). Each
row should be the sensitivity concentration for a separate species. If
species and/or group information is available then this can be saved as
<code>Species</code> and <code>Group</code> columns. The
<code>.csv</code> file can then be read into R using the following</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"path/to/file.csv"</span><span class="op">)</span></span></code></pre></div>
<p>For the purposes of this manual we use the CCME dataset for
boron.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ccme_boron</span> <span class="op">&lt;-</span> <span class="fu">ssddata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ssddata/man/ccme_boron.html" class="external-link">ccme_boron</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ccme_boron</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 28 × 5</span></span></span>
<span><span class="co">#&gt;    Chemical Species                  Conc Group        Units</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Boron    Oncorhynchus mykiss       2.1 Fish         mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Boron    Ictalurus punctatus       2.4 Fish         mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Boron    Micropterus salmoides     4.1 Fish         mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Boron    Brachydanio rerio        10   Fish         mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Boron    Carassius auratus        15.6 Fish         mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Boron    Pimephales promelas      18.3 Fish         mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Boron    Daphnia magna             6   Invertebrate mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Boron    Opercularia bimarginata  10   Invertebrate mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Boron    Ceriodaphnia dubia       13.4 Invertebrate mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Boron    Entosiphon sulcatum      15   Invertebrate mg/L </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-distributions">Fitting Distributions<a class="anchor" aria-label="anchor" href="#fitting-distributions"></a>
</h2>
<p>The function <code><a href="../reference/ssd_fit_dists.html">ssd_fit_dists()</a></code> inputs a data frame and
fits one or more distributions. The user can specify a subset of the
following 10 distributions</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ssd_dists_all.html">ssd_dists_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "burrIII3"      "gamma"         "gompertz"      "invpareto"    </span></span>
<span><span class="co">#&gt;  [5] "lgumbel"       "llogis"        "llogis_llogis" "lnorm"        </span></span>
<span><span class="co">#&gt;  [9] "lnorm_lnorm"   "weibull"</span></span></code></pre></div>
<p>using the <code>dists</code> argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssd_fit_dists.html">ssd_fit_dists</a></span><span class="op">(</span><span class="va">ccme_boron</span>, dists <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"llogis"</span>, <span class="st">"lnorm"</span>, <span class="st">"gamma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="coefficients">Coefficients<a class="anchor" aria-label="anchor" href="#coefficients"></a>
</h2>
<p>The estimates for the various terms can be extracted using the
tidyverse generic <code>tidy</code> function (or the base R generic
<code>coef</code> function).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   dist   term           est    se</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> llogis locationlog  2.63  0.248</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> llogis scalelog     0.740 0.114</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lnorm  meanlog      2.56  0.235</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> lnorm  sdlog        1.24  0.166</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> gamma  scale       25.1   7.64 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> gamma  shape        0.950 0.223</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h2>
<p>It is generally more informative to plot the fits using the
<code>autoplot</code> generic function (a wrapper on
<code><a href="../reference/ssd_plot_cdf.html">ssd_plot_cdf()</a></code>). As <code>autoplot</code> returns a
<code>ggplot</code> object it can be modified prior to plotting.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># set plot theme</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Species Sensitivity Distributions for Boron"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_colour_ssd.html">scale_colour_ssd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="selecting-one-distribution">Selecting One Distribution<a class="anchor" aria-label="anchor" href="#selecting-one-distribution"></a>
</h2>
<p>Given multiple distributions the user is faced with choosing the
“best” distribution (or as discussed below averaging the results
weighted by the fit).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ssd_gof.html">ssd_gof</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 9</span></span></span>
<span><span class="co">#&gt;   dist      ad     ks    cvm   aic  aicc   bic delta weight</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> llogis 0.487 0.099<span style="text-decoration: underline;">4</span> 0.059<span style="text-decoration: underline;">5</span>  241.  241.  244.  3.38  0.11 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> lnorm  0.507 0.107  0.070<span style="text-decoration: underline;">3</span>  239.  240.  242.  1.40  0.296</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> gamma  0.440 0.117  0.055<span style="text-decoration: underline;">4</span>  238.  238.  240.  0     0.595</span></span></code></pre></div>
<p>The <code><a href="../reference/ssd_gof.html">ssd_gof()</a></code> function returns three test statistics
that can be used to evaluate the fit of the various distributions to the
data.</p>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/Anderson%E2%80%93Darling_test" class="external-link">Anderson-Darling</a>
(<code>ad</code>) statistic,</li>
<li>
<a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" class="external-link">Kolmogorov-Smirnov</a>
(<code>ks</code>) statistic and</li>
<li>
<a href="https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion" class="external-link">Cramer-von
Mises</a> (<code>cvm</code>) statistic</li>
</ul>
<p>and three information criteria</p>
<ul>
<li>Akaike’s Information Criterion (<code>aic</code>),</li>
<li>Akaike’s Information Criterion corrected for sample size
(<code>aicc</code>) and</li>
<li>Bayesian Information Criterion (<code>bic</code>)</li>
</ul>
<p>Note if <code><a href="../reference/ssd_gof.html">ssd_gof()</a></code> is called with
<code>pvalue = TRUE</code> then the p-values rather than the statistics
are returned for the ad, ks and cvm tests.</p>
<p>Following <span class="citation">Burnham and Anderson (2002)</span>
we recommend the <code>aicc</code> for model selection. The best
predictive model is that with the lowest <code>aicc</code> (indicated by
the model with a <code>delta</code> value of 0.000 in the goodness of
fit table). In the current example the best predictive model is the
gamma distribution but the lnorm distribution has some support.</p>
<p>For further information on the advantages of an information theoretic
approach in the context of selecting SSDs the reader is referred to
<span class="citation">Fox et al. (2021)</span>.</p>
</div>
<div class="section level2">
<h2 id="averaging-multiple-distributions">Averaging Multiple Distributions<a class="anchor" aria-label="anchor" href="#averaging-multiple-distributions"></a>
</h2>
<p>Often other distributions will fit the data almost as well as the
best distribution as evidenced by <code>delta</code> values &lt; 2 <span class="citation">(Burnham and Anderson 2002)</span>. In this situation
the recommended approach is to estimate the average fit based on the
relative weights of the distributions <span class="citation">(Burnham
and Anderson 2002)</span>. The <code>aicc</code> based weights are
indicated by the <code>weight</code> column in the goodness of fit
table. In the current example, the gamma and log-normal distributions
have <code>delta</code> values &lt; 2.</p>
</div>
<div class="section level2">
<h2 id="estimating-the-fit">Estimating the Fit<a class="anchor" aria-label="anchor" href="#estimating-the-fit"></a>
</h2>
<p>The <code>predict</code> function can be used to generate
model-averaged (or if <code>average = FALSE</code> individual) estimates
by parametric bootstrapping. Model averaging is based on
<code>aicc</code> unless the data censored is which case
<code>aicc</code> in undefined. In this situation model averaging is
only possible if the distributions have the same number of parameters.
Parametric bootstrapping is computationally intensive. To bootstrap for
each distribution in parallel register the future backend and then
select the evaluation strategy.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">doFuture</span><span class="fu">::</span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html" class="external-link">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">boron_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fits</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The resultant object is a data frame of the estimated concentration
(<code>est</code>) with standard error (<code>se</code>) and lower
(<code>lcl</code>) and upper (<code>ucl</code>) 95% confidence limits
(CLs) by percent of species affected (<code>percent</code>). The object
includes the number of bootstraps (<code>nboot</code>) data sets
generated as well as the proportion of the data sets that successfully
fitted (<code>pboot</code>). There is no requirement for the bootstrap
samples to converge.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boron_pred</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 99 × 11</span></span></span>
<span><span class="co">#&gt;    dist    proportion   est    se    lcl   ucl    wt method  nboot pboot samples</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;I&lt;lis&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> average       0.01 0.267 0.401 0.041<span style="text-decoration: underline;">8</span>  1.53     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> average       0.02 0.531 0.517 0.110   2.03     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> average       0.03 0.783 0.614 0.198   2.50     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> average       0.04 1.02  0.700 0.300   2.90     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> average       0.05 1.26  0.781 0.407   3.29     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> average       0.06 1.48  0.859 0.520   3.72     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> average       0.07 1.71  0.933 0.645   4.16     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> average       0.08 1.93  1.01  0.768   4.58     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> average       0.09 2.16  1.08  0.896   4.95     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> average       0.1  2.38  1.15  1.03    5.39     1 parame…  <span style="text-decoration: underline;">1</span>000 0.999 <span style="color: #949494;">&lt;dbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 89 more rows</span></span></span></code></pre></div>
<p>The data frame of the estimates can then be plotted together with the
original data using the <code><a href="../reference/ssd_plot.html">ssd_plot()</a></code> function to summarize an
analysis. Once again the returned object is a <code>ggplot</code> object
which can be customized prior to plotting.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ssd_plot.html">ssd_plot</a></span><span class="op">(</span><span class="va">ccme_boron</span>, <span class="va">boron_pred</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"Group"</span>, label <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Concentration (mg/L)"</span>, ribbon <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span> <span class="op">+</span> <span class="co"># to ensure the species labels fit</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Species Sensitivity for Boron"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_colour_ssd.html">scale_colour_ssd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>In the above plot the model-averaged 95% confidence interval is
indicated by the shaded band and the model-averaged 5% Hazard
Concentration (<span class="math inline">\(HC_5\)</span>) by the dotted
line. Hazard concentrations are discussed below.</p>
</div>
<div class="section level2">
<h2 id="hazard-concentrations">Hazard Concentrations<a class="anchor" aria-label="anchor" href="#hazard-concentrations"></a>
</h2>
<p>The 5% hazard concentration (<span class="math inline">\(HC_5\)</span>) is the concentration that affects
5% of the species tested.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">boron_hc5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssd_hc.html">ssd_hc</a></span><span class="op">(</span><span class="va">fits</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">boron_hc5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 11</span></span></span>
<span><span class="co">#&gt;   dist    proportion   est    se   lcl   ucl    wt method    nboot pboot samples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;I&lt;lis&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> average       0.05  1.32 0.849 0.370  3.67     1 parametr…  <span style="text-decoration: underline;">1</span>000     1 <span style="color: #949494;">&lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>The <code>ssdtools</code> package provides four ggplot geoms to allow
you construct your own plots.</p>
<p>The first is <code><a href="../reference/geom_ssdpoint.html">geom_ssdpoint()</a></code> which plots species
sensitivity data</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ccme_boron</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_ssdpoint.html">geom_ssdpoint</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Conc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-14-1.png" width="384"></p>
<p>The second is <code>geom_ssdsegments()</code> which plots the range
of censored species sensitivity data</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ccme_boron</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_ssdsegment.html">geom_ssdsegment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Conc</span>, xend <span class="op">=</span> <span class="va">Conc</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<p>The third is <code><a href="../reference/geom_xribbon.html">geom_xribbon()</a></code> which plots species
sensitivity confidence intervals</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">boron_pred</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_xribbon.html">geom_xribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">lcl</span>, xmax <span class="op">=</span> <span class="va">ucl</span>, y <span class="op">=</span> <span class="va">proportion</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-16-1.png" width="384"></p>
<p>And the fourth is <code><a href="../reference/geom_hcintersect.html">geom_hcintersect()</a></code> which plots hazard
concentrations</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hcintersect.html">geom_hcintersect</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
<p>They can be combined together as follows</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">boron_pred</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_xribbon.html">geom_xribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">lcl</span>, xmax <span class="op">=</span> <span class="va">ucl</span>, y <span class="op">=</span> <span class="va">proportion</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">proportion</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_ssdsegment.html">geom_ssdsegment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccme_boron</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Conc</span> <span class="op">/</span> <span class="fl">2</span>, xend <span class="op">=</span> <span class="va">Conc</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_ssdpoint.html">geom_ssdpoint</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccme_boron</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Conc</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_ssdpoint.html">geom_ssdpoint</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccme_boron</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Conc</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Species Affected (%)"</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Concentration (mg/L)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gp</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hcintersect.html">geom_hcintersect</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">boron_hc5</span><span class="op">$</span><span class="va">est</span>, yintercept <span class="op">=</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-18-1.png" width="384"></p>
<p>To log the x-axis add the following code.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="va">gp</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_trans.html" class="external-link">coord_trans</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/trans_breaks.html" class="external-link">trans_breaks</a></span><span class="op">(</span><span class="st">"log10"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">10</span><span class="op">^</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">comma_signif</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gp</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hcintersect.html">geom_hcintersect</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">boron_hc5</span><span class="op">$</span><span class="va">est</span>, yintercept <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ssdtools_files/figure-html/unnamed-chunk-19-1.png" width="384"></p>
<p>The most recent plot can be saved as a file using
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code>, which also allows the user to set the
resolution.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"file_name.png"</span>, dpi <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span></code></pre></div>
<!-- ### Censored Data -->
<!-- Censored data is that for which only a lower and/or upper limit is known for a particular species.  -->
<!-- If the `right` argument in `ssd_fit_dists()` is different to the `left` argument then the data are considered to be censored.  -->
<!-- `fluazinam` is a censored data set from the `fitdistrplus` package. -->
<!-- ```{r} -->
<!-- data(fluazinam, package = "fitdistrplus") -->
<!-- head(fluazinam) -->
<!-- ``` -->
<!-- There are less goodness-of-fit statistics available for -->
<!-- fits to censored data (currently just `aic` and `bic`). -->
<!-- The `delta` values are calculated using `aic`. -->
<!-- As the sample size `n` is undefined for censored data, `aicc` cannot be calculated. -->
<!-- However, if all the models have the same number of parameters, the `aic` `delta` values are identical to those for `aicc`. -->
<!-- For this reason, `ssdtools` only permits the analysis of censored data using two-parameter models. -->
<!-- ```{r, eval = FALSE} -->
<!-- fluazinam_dists <- ssd_fit_dists(fluazinam, left = "left", right = "right") -->
<!-- ssd_gof(fluazinam_dists) -->
<!-- ``` -->
<!-- The model-averaged predictions (and hazard concentrations complete with 95% confidence limits) can be calculated using `aic` -->
<!-- ```{r, eval = FALSE} -->
<!-- set.seed(99) -->
<!-- fluazinam_pred <- predict(fluazinam_dists, ci = TRUE) -->
<!-- ``` -->
<!-- and the results plotted complete with arrows indicating the censorship. -->
<!-- ```{r} -->
<!-- ssd_plot(fluazinam, fluazinam_pred, -->
<!--   left = "left", right = "right", -->
<!--   xlab = "Concentration (mg/L)" -->
<!-- ) -->
<!-- ``` -->
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-burnham_model_2002" class="csl-entry">
Burnham, Kenneth P., and David R. Anderson, eds. 2002. <em>Model
<span>Selection</span> and <span>Multimodel</span>
<span>Inference</span></em>. New York, NY: Springer New York. <a href="https://doi.org/10.1007/b97636" class="external-link">https://doi.org/10.1007/b97636</a>.
</div>
<div id="ref-fox_recent_2021" class="csl-entry">
Fox, D. R., R. A. Dam, R. Fisher, G. E. Batley, A. R. Tillmanns, J.
Thorley, C. J. Schwarz, D. J. Spry, and K. McTavish. 2021. <span>“Recent
<span>Developments</span> in <span>Species</span>
<span>Sensitivity</span> <span>Distribution</span>
<span>Modeling</span>.”</span> <em>Environmental Toxicology and
Chemistry</em> 40 (2): 293–308. <a href="https://doi.org/10.1002/etc.4925" class="external-link">https://doi.org/10.1002/etc.4925</a>.
</div>
<div id="ref-posthuma_species_2001" class="csl-entry">
Posthuma, Leo, Glenn W Suter II, and Theo P Traas. 2001. <em>Species
Sensitivity Distributions in Ecotoxicology</em>. CRC press. <a href="https://www.routledge.com/Species-Sensitivity-Distributions-in-Ecotoxicology/Posthuma-II-Traas/p/book/9781566705783" class="external-link">https://www.routledge.com/Species-Sensitivity-Distributions-in-Ecotoxicology/Posthuma-II-Traas/p/book/9781566705783</a>.
</div>
<div id="ref-r" class="csl-entry">
R Core Team. 2018. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
<div id="ref-ggplot2" class="csl-entry">
Wickham, Hadley. 2016. <em><span class="nocase">ggplot2</span>: Elegant
Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-wickham_r_2016" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science:
Import, Tidy, Transform, Visualize, and Model Data</em>. First edition.
Sebastopol, CA: O’Reilly. <a href="https://r4ds.had.co.nz" class="external-link">https://r4ds.had.co.nz</a>.
</div>
</div>
</div>
<div class="section level2">
<h2 id="licensing">Licensing<a class="anchor" aria-label="anchor" href="#licensing"></a>
</h2>
<p>Copyright 2024 Province of British Columbia, Environment and Climate
Change Canada, and Australian Government Department of Climate Change,
Energy, the Environment and Water</p>
<p>The documentation is released under the <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">CC BY 4.0
License</a></p>
<p>The code is released under the <a href="https://www.apache.org/licenses/LICENSE-2.0" class="external-link">Apache License
2.0</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joethorley" class="external-link">Joe Thorley</a>, <a href="https://www.aims.gov.au/about/our-people/dr-rebecca-fisher" class="external-link">Rebecca Fisher</a>, <a href="https://training.ecotox.science/who-we-are/" class="external-link">David Fox</a>, <a href="https://www.sfu.ca/stat-actsci/department/profiles/carl-schwarz.html" class="external-link">Carl Schwarz</a>, <a href="https://www2.gov.bc.ca/" class="external-link">Province of British Columbia</a>, <a href="https://www.canada.ca/en/environment-climate-change.html" class="external-link">Environment and Climate Change Canada</a>, <a href="https://www.dcceew.gov.au/" class="external-link">Australian Government Department of Climate Change, Energy, the Environment and Water</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
